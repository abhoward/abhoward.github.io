<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script type="text/javascript" src="https://code.highcharts.com/highcharts.js"></script>
        <script type="text/javascript" src="https://code.highcharts.com/highcharts-more.js"></script>
        <script src="https://code.highcharts.com/modules/pictorial.js"></script>
    </head>
    <body style="margin:0;padding:0">
        <div id="container" style="width:100%;height:100%">Loading....</div>
        <script>
            var monCountsLink = 'https://raw.githubusercontent.com/abhoward/abhoward.github.io/main/data/Pokemon/safari_week_2023_mon_counts.json';
            var monEncountersLink = 'https://raw.githubusercontent.com/abhoward/abhoward.github.io/main/data/Pokemon/safari_week_2023_mon_encounters.json';

            var dragonairSVGLink = 'https://raw.githubusercontent.com/abhoward/abhoward.github.io/main/assets/pokemon/svg_paths/dragonair.txt'
            var kangaskhanSVGLink = 'https://raw.githubusercontent.com/abhoward/abhoward.github.io/main/assets/pokemon/svg_paths/kangaskhan.txt'
            var chanseySVGLink = 'https://raw.githubusercontent.com/abhoward/abhoward.github.io/main/assets/pokemon/svg_paths/chansey.txt'
            var taurosSVGLink = 'https://raw.githubusercontent.com/abhoward/abhoward.github.io/main/assets/pokemon/svg_paths/beldum.txt'
            var scytherSVGLink = 'https://raw.githubusercontent.com/abhoward/abhoward.github.io/main/assets/pokemon/svg_paths/scyther.txt'
            var metangSVGLink = 'https://raw.githubusercontent.com/abhoward/abhoward.github.io/main/assets/pokemon/svg_paths/gastly.txt'

            function createHighchart(data1, data2, data3, data4, data5, data6, data7, data8) {
                var monCounts = data1[0];
                var monEncounters = data2[0];

                var dragonairSVG = data3[0];
                var kangaskhanSVG = data4[0];
                var chanseySVG = data5[0];
                var taurosSVG = data6[0];
                var scytherSVG = data7[0];
                var metangSVG = data8[0];

                Highcharts.chart('container', {
                    'chart': {
                        'type': 'pictorial'
                    },
                    'title': {
                        'text': '<b>Safari Week 2023</b></br>Rare Hunts'
                    },
                    'plotOptions': {
                        'series': {
                            'stacking': 'percent',
                            'pointPadding': 0,
                            'groupPadding': 0,
                            'dataLabels': {
                                'enabled': true
                            },
                            'cursor': 'pointer',
                            'events': {
                                'click': function(e) {
                                    console.log(e)
                                    window.open(e.point.id, '_blank');
                                }
                            },
                            'paths': [{
                                'definition': dragonairSVG
                            }, {
                                'definition': kangaskhanSVG
                            }, {
                                'definition': chanseySVG
                            },{
                                'definition': taurosSVG
                            },{
                                'definition': scytherSVG
                            },{
                                'definition': metangSVG
                            }]
                        }
                    },
                    'subtitle': {
                        'text': "Click the hunts below to open the corresponding tweet in a new tab.<br><i>Only includes tweets that contain the hashtag #safariweek or #safariweek2023. Sorted by encounters.</i>"
                    },
                    'legend': {
                        'enabled': false
                    },
                    'tooltip': {
                        'pointFormatter': function() {
                            return '<span style="color:' + this.color + ';font-weight: bold;">' + this.name + '</span>: ' + Highcharts.numberFormat(this.y, 0, " ",",");
                        },
                        'outside': true,
                        'headerformat': '<b>' + this.id + '</b><br>'
                    },
                    'xAxis': {
                        'categories': ['Dragonair', 'Kangaskhan', 'Chansey', 'Tauros', 'Scyther', 'Metang'],
                        'visible': true,
                        'opposite': true
                    },
                    'yAxis': {
                        'visible': false,
                        'stackShadow': {
                            'enabled': true
                        }
                    },
                    'series': [
                        {
                            'name': 'Encounters',
                            'keys': ['name', 'y', 'id', 'color'],
                            'data': [
                                ['Dragonair', 132931, 'https://twitter.com/twitter/status/1667492253873455107', 'rgba(208,62,203,0.9)'],
                                ['Kangaskhan', 56690, 'https://twitter.com/twitter/status/1667287777594036224', 'rgb(216,212,177)'],
                                ['Chansey', 38545, 'https://twitter.com/twitter/status/1666591299317686272', 'rgb(254,230,156)'],
                                ['Tauros', 38256, 'https://twitter.com/twitter/status/1667367034005364736', 'rgb(88,200,242)'],
                                ['Scyther', 36900, 'https://twitter.com/twitter/status/1668411866815627264', 'rgb(147,237,51)'],
                                ['Metang', 22396, 'https://twitter.com/twitter/status/1668411866815627264', 'rgb(147,237,51)']
                            ]
                        },
                        {
                            'name': 'Encounters',
                            'keys': ['name', 'y', 'id', 'color'],
                            'data': [
                                ['Dragonair', 20192, 'https://twitter.com/twitter/status/1667492253873455107', 'rgba(208,62,204,0.7)'],
                                ['Kangaskhan', 7, 'https://twitter.com/twitter/status/1667287777594036224', 'rgb(216,212,178)'],
                                ['Chansey', 19028, 'https://twitter.com/twitter/status/1666591299317686272', 'rgb(254,230,155)'],
                                ['Tauros', 78218, 'https://twitter.com/twitter/status/1667367034005364736', 'rgb(88,200,241)'],
                                ['Scyther', 921, 'https://twitter.com/twitter/status/1668411866815627264', 'rgb(147,237,50)'],
                                ['Metang', 26172, 'https://twitter.com/twitter/status/1668411866815627264', 'rgb(147,237,50)']
                            ]
                        }
                    // {
                    //     'name': 'Encounters',
                    //     'data': [[132931, 20192], [38545, 19028], [36900, 78218], [38256, 921], [56690, 7], [22396, 26172]]
                    // }
                    // {
                    //     'name': 'Chansey',
                    //     'data': [38545, 19028]
                    // },
                    // {
                    //     'name': 'Scyther',
                    //     'data': [36900, 78218]
                    // },
                    // {
                    //     'name': 'Tauros',
                    //     'data': [38256, 921]
                    // },
                    // {
                    //     'name': 'Kangaskhan',
                    //     'data': [56690, 7]
                    // },
                    // {
                    //     'name': 'Metang',
                    //     'data': [22396, 26172]
                    // }
                    ]
                })
            }

            function ajaxCalls() {
                return [
                    $.ajax({
                        url: monCountsLink,
                        dataType: 'json'
                    }),
                    $.ajax({
                        url: monEncountersLink,
                        dataType: 'json'
                    }),
                    $.ajax({
                        url: dragonairSVGLink,
                        dataType: 'text'
                    }),
                    $.ajax({
                        url: kangaskhanSVGLink,
                        dataType: 'text'
                    }),
                    $.ajax({
                        url: chanseySVGLink,
                        dataType: 'text'
                    }),
                    $.ajax({
                        url: taurosSVGLink,
                        dataType: 'text'
                    }),
                    $.ajax({
                        url: scytherSVGLink,
                        dataType: 'text'
                    }),
                    $.ajax({
                        url: metangSVGLink,
                        dataType: 'text'
                    })
                ];
            }

            $.when.apply($, ajaxCalls()).then(createHighchart);
        </script>
    </body>
</html>