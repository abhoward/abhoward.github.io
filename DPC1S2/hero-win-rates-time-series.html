<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script type="text/javascript" src="https://code.highcharts.com/highcharts.js"></script>
        <script type="text/javascript" src="https://code.highcharts.com/highcharts-more.js"></script>
        <script type="text/javascript" src="https://code.highcharts.com/modules/drilldown.js"></script>
    </head>
    <body style="margin:0;padding:0;height:100vh">
        <div id="container" style="width:100%;height:100%">Loading....</div>
        <script>
            var heroPickRatesLink = 'https://raw.githubusercontent.com/abhoward/abhoward.github.io/main/data/DPC1S2/animajor/hero_prs.json';
            var heroBanRatesLink = 'https://raw.githubusercontent.com/abhoward/abhoward.github.io/main/data/DPC1S2/animajor/hero_brs.json';
            var heroWinRatesLink = 'https://raw.githubusercontent.com/abhoward/abhoward.github.io/main/data/DPC1S2/animajor/hero_win_rates.json';
            var heroPickRatesTSLink = 'https://raw.githubusercontent.com/abhoward/abhoward.github.io/main/data/DPC1S2/animajor/hero_prs_ts.json';
            var heroBanRatesTSLink = 'https://raw.githubusercontent.com/abhoward/abhoward.github.io/main/data/DPC1S2/animajor/hero_brs_ts.json';
            var heroWinRatesTSLink = 'https://raw.githubusercontent.com/abhoward/abhoward.github.io/main/data/DPC1S2/animajor/hero_wrs_ts.json';

            function createHighchart(data1, data2, data3, data4, data5, data6) {
                var heroPickRates = data1[0];
                var heroBanRates = data2[0];
                var heroWinRates = data3[0];
                var heroPickRatesTS = data4[0];
                var heroBanRatesTS = data5[0];
                var heroWinRatesTS = data6[0];

                var xList = Array()
                Object.keys(heroWinRates).forEach(function(key) {
                    xList.push(heroWinRates[key].name);
                })

                Highcharts.setOptions({
                    'time': {
                        'useUTC': false
                    }
                });

                Highcharts.chart('container', {

                    'chart': {
                        'type': 'column',
                        'zoomType': 'x'
                    },
                    'title': {
                        'text': 'Hero Rates Over Time'
                    },
                    'subtitle': {
                        'text': 'Click on the bars or hero names to drill down to team stats. Source: opendota.com.<br><i>Excludes matches <code>6025172903</code>, <code>6023211594</code> and <code>6023110186</code> due to lack of data.</i>'
                    },
                    'legend': {
                        'verticalAlign': 'top'
                    },
                    'plotOptions': {
                        'series': {
                            'grouping': true,
                            'events': {
                                'legendItemClick': function(event) {
                                    var s = this.chart.series;
                                    for(i = 0; i < s.length; i++) {
                                        if(this.name == 'Toggle All' && this.visible == true)
                                            s[i].setVisible(false);
                                        else if(this.name == 'Toggle All' && this.visible == false)
                                            s[i].setVisible(true);
                                        else if (this == s[i] && this.visible == false)
                                            s[i].setVisible(true);
                                        else if (this == s[i] && this.visible == true)
                                            s[i].setVisible(false);
                                    }
                                    return false;
                                }
                            }
                        },
                        'column': {
                            'zones': [
                                {
                                'value': 0.25, 
                                'color': '#f56969'
                                }, 
                                {
                                'value': 0.5, 
                                'color': '#d8db53'
                                }, 
                                {'value': 0.9, 
                                 'color': '#1ac73d'
                                }, 
                                {'value': 1.01, 
                                 'color': '#1a48c7'
                                }
                            ]
                        },
                        'areaspline': {
                            'fillColor': {
                                'linearGradient': {'x1': 0, 'x2': 0, 'y1': 1, 'y2': 0},
                                'stops': [
                                    [0, '#6B0000'],
                                    [0.125, '#B03535'],
                                    [0.25, '#F56969'],
                                    [0.375, '#E7A25E'],
                                    [0.5, '#d8db53'],
                                    [0.625, '#79D148'],
                                    [0.75, '#1AC73D'],
                                    [0.875, '#1A8882'],
                                    [1, '#1A48C7']
                                ],
                            },
                            'opacity': 0.7
                        }
                    },
                    'tooltip': {
                        'shared': true,
                        'pointFormatter': function() {
                            var value = this.y*100;
                            value = value.toFixed(2) + '%'
                            console.log(this);
                            if (typeof this.zone.color != "undefined") {
                                return '<span style="color:' + this.zone.color + '">' + this.series.name + '</span>: <b>' + value + '</b><br />';
                            } else {
                                return '<span style="color:' + this.series.color + '">' + this.series.userOptions.id + '</span>: <b>' + value + '</b><br />';
                            }
                        },
                        'headerFormat': '<b>{point.key}</b><br>'
                    },
                    'xAxis': [{
                        'type': 'category',
                        'title': {
                            'text': 'Hero'
                        },
                        'showEmpty': false
                    },
                    {
                        'type': 'datetime',
                        'title': {
                            'text': 'Date'
                        },
                        'showEmpty': false,
                        'plotLines': [{
                            'label': {
                                'text': 'Wildcard',
                                'style': {
                                    'color': 'black',
                                    'fontWeight': 'bold',
                                    'fontSize': 25
                                }
                            },
                            'color': '#090142', 
                            'width': 3,
                            'value': 1622631939000,
                            'dashStyle': 'longdashdot',
                            'zIndex': 3
                        },
                        {
                            'label': {
                                'text': 'Group Stage',
                                'style': {
                                    'color': 'black',
                                    'fontWeight': 'bold',
                                    'fontSize': 25
                                }
                            },
                            'color': '#090142', 
                            'width': 3,
                            'value': 1622804403000,
                            'dashStyle': 'longdashdot',
                            'zIndex': 3
                        },
                        {
                            'label': {
                                'text': 'Playoffs',
                                'style': {
                                    'color': 'black',
                                    'fontWeight': 'bold',
                                    'fontSize': 25
                                }
                            },
                            'color': '#090142', 
                            'width': 3,
                            'value': 1623230671000,
                            'dashStyle': 'longdashdot',
                            'zIndex': 3
                        }]
                    }],
                    'yAxis': { // Primary Axis
                        'min': 0,
                        'maxPadding': 0,
                        'title': {
                            'text': 'Rate'
                        },
                        'labels': {
                            'formatter': function () {
                                var value = Math.trunc(this.value*100);
                                return value + '%';
                            }
                        }
                    },
                    'series': [
                        {
                            'type': 'column',
                            'name': 'Pick Rate',
                            'color': 'rgba(72, 219, 119, 1)',
                            'data': heroPickRates
                        },
                        {
                            'type': 'column',
                            'name': 'Ban Rate',
                            'color': 'rgba(72, 219, 119, 1)',
                            'data': heroBanRates,
                            'visible': false
                        },
                        {
                            'type': 'column',
                            'name': 'Win Rate',
                            'color': 'rgba(72, 219, 119, 1)',
                            'data': heroWinRates,
                            'visible': false
                        },
                        {
                            'type': 'line',
                            'name': 'Toggle All',
                            'marker': {
                                'enabled': false
                            },
                            'data': []
                        }
                    ],
                    'drilldown': {
                        'drillUpButton': {
                            'theme': {
                                'fill': 'white',
                                'stroke-width': 1,
                                'stroke': 'silver',
                                'r': 0
                            }
                        },
                        'series': [
                            {
                                "name": "Anti-Mage Pick Rate",
                                "id": "Anti-Mage Pick Rate",
                                'type': 'areaspline',
                                'xAxis': 1,
                                'color': 'red',
                                "data": [
                                    [
                                        1622631939000.0,
                                        0.0
                                    ],
                                    [
                                        1622632711000.0,
                                        0.0
                                    ],
                                    [
                                        1622633088000.0,
                                        0.0
                                    ],
                                    [
                                        1622636790000.0,
                                        0.0
                                    ],
                                    [
                                        1622637744000.0,
                                        0.0
                                    ],
                                    [
                                        1622637774000.0,
                                        0.0
                                    ],
                                    [
                                        1622642467000.0,
                                        0.0
                                    ],
                                    [
                                        1622642538000.0,
                                        0.0
                                    ],
                                    [
                                        1622646441000.0,
                                        0.0
                                    ],
                                    [
                                        1622646606000.0,
                                        0.0
                                    ],
                                    [
                                        1622650991000.0,
                                        0.0
                                    ],
                                    [
                                        1622652015000.0,
                                        0.0
                                    ],
                                    [
                                        1622655993000.0,
                                        0.07692307692307693
                                    ],
                                    [
                                        1622656597000.0,
                                        0.07142857142857142
                                    ],
                                    [
                                        1622660675000.0,
                                        0.06666666666666667
                                    ],
                                    [
                                        1622660725000.0,
                                        0.0625
                                    ],
                                    [
                                        1622664784000.0,
                                        0.058823529411764705
                                    ],
                                    [
                                        1622664861000.0,
                                        0.05555555555555555
                                    ],
                                    [
                                        1622717946000.0,
                                        0.05263157894736842
                                    ],
                                    [
                                        1622718100000.0,
                                        0.05
                                    ],
                                    [
                                        1622722138000.0,
                                        0.047619047619047616
                                    ],
                                    [
                                        1622722222000.0,
                                        0.045454545454545456
                                    ],
                                    [
                                        1622726353000.0,
                                        0.043478260869565216
                                    ],
                                    [
                                        1622726482000.0,
                                        0.041666666666666664
                                    ],
                                    [
                                        1622729379000.0,
                                        0.04
                                    ],
                                    [
                                        1622729936000.0,
                                        0.07692307692307693
                                    ],
                                    [
                                        1622732908000.0,
                                        0.07407407407407407
                                    ],
                                    [
                                        1622734499000.0,
                                        0.07142857142857142
                                    ],
                                    [
                                        1622736322000.0,
                                        0.06896551724137931
                                    ],
                                    [
                                        1622743867000.0,
                                        0.06666666666666667
                                    ],
                                    [
                                        1622748047000.0,
                                        0.06451612903225806
                                    ],
                                    [
                                        1622751689000.0,
                                        0.0625
                                    ],
                                    [
                                        1622756849000.0,
                                        0.06060606060606061
                                    ],
                                    [
                                        1622804403000.0,
                                        0.058823529411764705
                                    ],
                                    [
                                        1622804574000.0,
                                        0.05714285714285714
                                    ],
                                    [
                                        1622808887000.0,
                                        0.05555555555555555
                                    ],
                                    [
                                        1622808907000.0,
                                        0.05405405405405406
                                    ],
                                    [
                                        1622814077000.0,
                                        0.05263157894736842
                                    ],
                                    [
                                        1622814430000.0,
                                        0.07692307692307693
                                    ],
                                    [
                                        1622817328000.0,
                                        0.075
                                    ],
                                    [
                                        1622818537000.0,
                                        0.07317073170731707
                                    ],
                                    [
                                        1622822563000.0,
                                        0.07142857142857142
                                    ],
                                    [
                                        1622822865000.0,
                                        0.06976744186046512
                                    ],
                                    [
                                        1622826222000.0,
                                        0.06818181818181818
                                    ],
                                    [
                                        1622826627000.0,
                                        0.06666666666666667
                                    ],
                                    [
                                        1622831088000.0,
                                        0.06521739130434782
                                    ],
                                    [
                                        1622831318000.0,
                                        0.06382978723404255
                                    ],
                                    [
                                        1622835214000.0,
                                        0.0625
                                    ],
                                    [
                                        1622835495000.0,
                                        0.061224489795918366
                                    ],
                                    [
                                        1622890797000.0,
                                        0.06
                                    ],
                                    [
                                        1622891010000.0,
                                        0.058823529411764705
                                    ],
                                    [
                                        1622894871000.0,
                                        0.057692307692307696
                                    ],
                                    [
                                        1622895568000.0,
                                        0.05660377358490566
                                    ],
                                    [
                                        1622900137000.0,
                                        0.05555555555555555
                                    ],
                                    [
                                        1622901447000.0,
                                        0.05454545454545454
                                    ],
                                    [
                                        1622903553000.0,
                                        0.05357142857142857
                                    ],
                                    [
                                        1622905426000.0,
                                        0.05263157894736842
                                    ],
                                    [
                                        1622907506000.0,
                                        0.05172413793103448
                                    ],
                                    [
                                        1622910331000.0,
                                        0.05084745762711865
                                    ],
                                    [
                                        1622911133000.0,
                                        0.05
                                    ],
                                    [
                                        1622914161000.0,
                                        0.04918032786885246
                                    ],
                                    [
                                        1622915706000.0,
                                        0.04838709677419355
                                    ],
                                    [
                                        1622918883000.0,
                                        0.047619047619047616
                                    ],
                                    [
                                        1622920176000.0,
                                        0.046875
                                    ],
                                    [
                                        1622922352000.0,
                                        0.046153846153846156
                                    ],
                                    [
                                        1622977177000.0,
                                        0.045454545454545456
                                    ],
                                    [
                                        1622977260000.0,
                                        0.04477611940298507
                                    ],
                                    [
                                        1622981160000.0,
                                        0.04411764705882353
                                    ],
                                    [
                                        1622981251000.0,
                                        0.043478260869565216
                                    ],
                                    [
                                        1622985258000.0,
                                        0.04285714285714286
                                    ],
                                    [
                                        1622986257000.0,
                                        0.04225352112676056
                                    ],
                                    [
                                        1622987659000.0,
                                        0.041666666666666664
                                    ],
                                    [
                                        1622990163000.0,
                                        0.0410958904109589
                                    ],
                                    [
                                        1622991216000.0,
                                        0.04054054054054054
                                    ],
                                    [
                                        1622994589000.0,
                                        0.04
                                    ],
                                    [
                                        1622995452000.0,
                                        0.039473684210526314
                                    ],
                                    [
                                        1622998076000.0,
                                        0.03896103896103896
                                    ],
                                    [
                                        1623003016000.0,
                                        0.038461538461538464
                                    ],
                                    [
                                        1623003165000.0,
                                        0.0379746835443038
                                    ],
                                    [
                                        1623006718000.0,
                                        0.0375
                                    ],
                                    [
                                        1623007177000.0,
                                        0.037037037037037035
                                    ],
                                    [
                                        1623060003000.0,
                                        0.036585365853658534
                                    ],
                                    [
                                        1623063371000.0,
                                        0.03614457831325301
                                    ],
                                    [
                                        1623069370000.0,
                                        0.03571428571428571
                                    ],
                                    [
                                        1623075039000.0,
                                        0.03529411764705882
                                    ],
                                    [
                                        1623080346000.0,
                                        0.03488372093023256
                                    ],
                                    [
                                        1623083517000.0,
                                        0.034482758620689655
                                    ],
                                    [
                                        1623088050000.0,
                                        0.03409090909090909
                                    ],
                                    [
                                        1623091624000.0,
                                        0.033707865168539325
                                    ],
                                    [
                                        1623096134000.0,
                                        0.03333333333333333
                                    ],
                                    [
                                        1623230671000.0,
                                        0.03296703296703297
                                    ],
                                    [
                                        1623234620000.0,
                                        0.03260869565217391
                                    ],
                                    [
                                        1623240078000.0,
                                        0.03225806451612903
                                    ],
                                    [
                                        1623244210000.0,
                                        0.031914893617021274
                                    ],
                                    [
                                        1623251394000.0,
                                        0.031578947368421054
                                    ],
                                    [
                                        1623260677000.0,
                                        0.03125
                                    ],
                                    [
                                        1623263689000.0,
                                        0.030927835051546393
                                    ],
                                    [
                                        1623267881000.0,
                                        0.030612244897959183
                                    ],
                                    [
                                        1623273241000.0,
                                        0.030303030303030304
                                    ],
                                    [
                                        1623276704000.0,
                                        0.03
                                    ],
                                    [
                                        1623316867000.0,
                                        0.0297029702970297
                                    ],
                                    [
                                        1623321133000.0,
                                        0.029411764705882353
                                    ],
                                    [
                                        1623326349000.0,
                                        0.02912621359223301
                                    ],
                                    [
                                        1623331670000.0,
                                        0.028846153846153848
                                    ],
                                    [
                                        1623336307000.0,
                                        0.02857142857142857
                                    ],
                                    [
                                        1623340375000.0,
                                        0.02830188679245283
                                    ],
                                    [
                                        1623346065000.0,
                                        0.028037383177570093
                                    ],
                                    [
                                        1623350348000.0,
                                        0.027777777777777776
                                    ],
                                    [
                                        1623354039000.0,
                                        0.027522935779816515
                                    ],
                                    [
                                        1623359795000.0,
                                        0.02727272727272727
                                    ],
                                    [
                                        1623363949000.0,
                                        0.02702702702702703
                                    ],
                                    [
                                        1623367842000.0,
                                        0.026785714285714284
                                    ],
                                    [
                                        1623402001000.0,
                                        0.02654867256637168
                                    ],
                                    [
                                        1623406607000.0,
                                        0.02631578947368421
                                    ],
                                    [
                                        1623412949000.0,
                                        0.02608695652173913
                                    ],
                                    [
                                        1623416978000.0,
                                        0.02586206896551724
                                    ],
                                    [
                                        1623421901000.0,
                                        0.02564102564102564
                                    ],
                                    [
                                        1623429205000.0,
                                        0.025423728813559324
                                    ],
                                    [
                                        1623432979000.0,
                                        0.025210084033613446
                                    ],
                                    [
                                        1623436867000.0,
                                        0.025
                                    ],
                                    [
                                        1623442379000.0,
                                        0.024793388429752067
                                    ],
                                    [
                                        1623446701000.0,
                                        0.02459016393442623
                                    ],
                                    [
                                        1623451273000.0,
                                        0.024390243902439025
                                    ],
                                    [
                                        1623488462000.0,
                                        0.024193548387096774
                                    ],
                                    [
                                        1623492171000.0,
                                        0.024
                                    ],
                                    [
                                        1623497683000.0,
                                        0.023809523809523808
                                    ],
                                    [
                                        1623500970000.0,
                                        0.023622047244094488
                                    ],
                                    [
                                        1623505211000.0,
                                        0.0234375
                                    ],
                                    [
                                        1623510542000.0,
                                        0.023255813953488372
                                    ],
                                    [
                                        1623514621000.0,
                                        0.023076923076923078
                                    ],
                                    [
                                        1623518001000.0,
                                        0.022900763358778626
                                    ],
                                    [
                                        1623524613000.0,
                                        0.022727272727272728
                                    ],
                                    [
                                        1623528443000.0,
                                        0.022556390977443608
                                    ],
                                    [
                                        1623532965000.0,
                                        0.022388059701492536
                                    ],
                                    [
                                        1623590649000.0,
                                        0.022222222222222223
                                    ],
                                    [
                                        1623595046000.0,
                                        0.022058823529411766
                                    ],
                                    [
                                        1623601209000.0,
                                        0.021897810218978103
                                    ],
                                    [
                                        1623610498000.0,
                                        0.021739130434782608
                                    ],
                                    [
                                        1623614300000.0,
                                        0.02158273381294964
                                    ],
                                    [
                                        1623619081000.0,
                                        0.02142857142857143
                                    ]
                                ]
                            }
                        ]
                    }
                });
            }

            function ajaxCalls() {
                return [
                    $.ajax({
                        url: heroPickRatesLink,
                        dataType: 'json'
                    }),
                    $.ajax({
                        url: heroBanRatesLink,
                        dataType: 'json'
                    }),
                    $.ajax({
                        url: heroWinRatesLink,
                        dataType: 'json'
                    }),
                    $.ajax({
                        url: heroPickRatesTSLink,
                        dataType: 'json'
                    }),
                    $.ajax({
                        url: heroBanRatesTSLink,
                        dataType: 'json'
                    }),
                    $.ajax({
                        url: heroWinRatesTSLink,
                        dataType: 'json'
                    })
                ];
            }

            $.when.apply($, ajaxCalls()).then(createHighchart);
        </script>
    </body>
</html>